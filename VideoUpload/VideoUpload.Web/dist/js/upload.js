!function(a,t,d){var o={frmUpload:a("#frmUpload"),appModal:a("#appModal"),txtFile:a("#Attachments"),btnSubmit:a("#btnSubmit"),modalContent:a("#appModal .modal-content"),mceContainer:a(".mce-container")};t.init=function(){d.init({selector:"#Description",branding:!1,menubar:!1,toolbar:!1,statusbar:!1,content_css:"../../dist/css/app.min.css"}),a(".mce-container").addClass(".mce-conatiner-custom"),e()};var e=function(){o.frmUpload.on("submit",function(t){t.preventDefault();for(var d=a(this),e=o.txtFile.get(0).files,n=new FormData,s=0;s<e.length;s++)n.append("Attachments",e[s]);a("input[type='text'").each(function(t,d){n.append(a(d).attr("name"),a(d).val())}),n.append("Description",tinyMCE.activeEditor.getContent({format:"raw"})),o.appModal.modal({keyboard:!1,backdrop:"static"}),o.appModal.modal("show");var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t=JSON.parse(this.responseText);t.success?function(t){var d=o.appModal.find(".modal-title"),e=o.appModal.find(".progress-bar"),n=o.appModal.find(".modal-content");d.html(t),e.css("width","100%").removeClass("active").html("100%"),o.btnSubmit.removeClass("disabled").html("Upload");var s=a("<div></div>").addClass("modal-footer"),i=a("<button></button>").addClass("btn btn-primary pull-right").attr({id:"btnUploadExit","data-status":"success"}).html("Close");s.append(i),n.append(s)}(t.message):function(t){var d=o.appModal.find(".modal-title"),e=o.appModal.find(".modal-body"),n=o.appModal.find(".modal-content");d.html("Upload failed"),e.empty(),e.append('<p class="text-center">'+t+"</p>"),o.btnSubmit.removeClass("disabled").html("Upload");var s=a("<div></div>").addClass("modal-footer"),i=a("<button></button>").addClass("btn btn-primary pull-right").attr({id:"btnUploadExit","data-status":"failed"}).html("Close");s.append(i),n.append(s)}(t.message)}},i.upload.addEventListener("progress",function(t){var d=t.loaded/t.total,e=Math.floor(100*d).toString()+"%";progressBar=o.appModal.find(".progress-bar"),progressBar.css("width",e).addClass("progress-bar-striped active").html(e),"100%"===e&&o.appModal.find(".modal-title").html("Your video is now being converted. Please do not interrupt"),a("#btnSubmit").html("<i class='fa fa-spin'></i>Loading...").addClass("disabled")}),i.open("post",d.attr("action"),!0),i.send(n)}),o.appModal.on("show.bs.modal",function(){var t=a(this),d=t.find(".modal-title"),o=t.find(".close"),e=t.find(".modal-body");d.html("Upload in progress"),o.addClass("hidden"),e.empty();var n=a("<div></div>");n.addClass("progress");var s=a("<div></div>");s.addClass("progress-bar"),n.append(s),e.append(n)}),o.modalContent.on("click","#btnUploadExit",function(){if("success"===a(this).data("status")){var t=location.href.toLowerCase();location.href=t.replace("/videos/upload","")}else o.appModal.modal("hide")}),o.appModal.on("hidden.bs.modal",function(){var t=a(this);t.find(".modal-body").empty(),t.find(".modal-footer").remove()})}}(jQuery,window.UploadWidget=window.UploadWidget||{},tinymce),UploadWidget.init();